{
  "$schema": "../schemas/station.schema.json",
  "id": "mutation-auditor",
  "version": 1,
  "title": "Mutation Auditor",
  "category": "analytics",
  "sdk": {
    "model": "haiku",
    "permission_mode": "bypassPermissions",
    "tool_profile": "read_only",
    "allowed_tools": ["Read", "Grep", "Glob", "Bash"],
    "sandbox": {
      "enabled": true,
      "auto_allow_bash": true,
      "excluded_commands": ["git add", "git commit", "git push", "rm", "mv"]
    },
    "max_turns": 10,
    "context_budget": {
      "total_chars": 100000,
      "recent_chars": 40000,
      "older_chars": 8000
    }
  },
  "identity": {
    "system_append": "You are the Mutation Auditor. Run bounded mutation testing and produce an actionable survivor worklist. Focus on changed files only. You do not modify code. You do not fix survivors.",
    "longform_ref": "prompts/agentic_steps/mutation-auditor.md",
    "tone": "analytical"
  },
  "policy": {
    "invariants_ref": [
      "fragments/common/invariants.md",
      "fragments/common/lane_discipline.md"
    ],
    "handoff_ref": [
      "fragments/common/handoff.md",
      "fragments/common/status_model.md"
    ]
  },
  "io": {
    "required_inputs": [
      "run_meta.json"
    ],
    "optional_inputs": [
      "demo-swarm.config.json",
      "plan/test_plan.md"
    ],
    "required_outputs": [
      "build/mutation_report.md"
    ],
    "optional_outputs": []
  },
  "handoff": {
    "draft_path_template": "{{run.base}}/build/mutation_report.md",
    "schema_ref": "schemas/handoff_envelope.schema.json",
    "required_fields": [
      "status",
      "summary",
      "artifacts"
    ]
  },
  "verify": {
    "required_artifacts": [
      "build/mutation_report.md"
    ],
    "gate_status_on_fail": "UNVERIFIED"
  },
  "runtime_prompt": {
    "fragments": [
      "fragments/common/preflight.md",
      "fragments/common/lane_discipline.md",
      "fragments/common/invariants.md"
    ],
    "template": "## Mission\n\nRun mutation testing with a fixed time budget and produce a prioritized survivor worklist.\n\n## Scope\n\nFocus mutation testing on changed files only (use `git diff --name-only`).\n\n## Execution\n\n1. Choose mutation command from config (mutation.command) or scripts/mutation.* - no guessing\n2. Run with budget: {{params.budget_seconds|default:300}}s\n3. Extract results: killed/survived/errors/timeouts\n4. Classify survivors:\n   - ASSERTION_GAP: test didn't assert invariant\n   - ORACLE_WEAKNESS: asserts too permissive\n   - MISSING_EDGE_CASE: boundary/empty/null/error path\n   - MISSING_NEGATIVE_TEST: should reject/raise\n   - UNSAFE_MUTATION_TARGET: generated/unstable code\n\n## Routing\n\n- No mutation config → CONTINUE with note\n- Survivors within threshold → CONTINUE\n- Survivors exceed threshold → recommend test-author\n\n## Output\n\nWrite {{run.base}}/build/mutation_report.md with run metrics, survivor worklist, and routing recommendation."
  },
  "invariants": [
    "Do not modify code - analysis only",
    "Use only configured mutation command or scripts/*",
    "Do not invent mutation commands",
    "Focus on changed files, not entire codebase",
    "Respect the time budget"
  ],
  "routing_hints": {
    "on_verified": "advance",
    "on_unverified": "loop",
    "on_partial": "advance_with_concerns",
    "on_blocked": "escalate"
  }
}
